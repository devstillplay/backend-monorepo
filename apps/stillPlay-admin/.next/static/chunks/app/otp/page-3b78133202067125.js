(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[636],{2592:function(e,n,t){Promise.resolve().then(t.bind(t,2489))},2489:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return b}});var i=t(7437),r=t(8984),s=t(1899),a=t(5002),l=t(4013),o=t(2279),c=t(1770),d=t(9376),u=t(2265),h=t(6596),g=t(2603),x=t(3675),m=t(8094),f=t(9099),p=t(8219);function y(){var e;let n=(0,d.useRouter)(),t=null!==(e=(0,d.useSearchParams)().get("flow"))&&void 0!==e?e:"login",{otpEmail:y,otpExpiresAt:b,status:j,setAuthenticated:v,reset:Z,fullName:k}=(0,f.t)(),S=(0,p.LM)(e=>e.setProfile),C=(0,p.LM)(e=>e.reset),[I,w]=(0,u.useState)(""),[P,N]=(0,u.useState)(0);(0,u.useEffect)(()=>{if("authenticated"===j){n.replace("/dashboard");return}if("otp_required"!==j){n.replace("/");return}let e=setInterval(()=>{let e=Math.max(0,(null!=b?b:0)-Date.now());N(e),0===e&&(Z(),C())},1e3);return()=>clearInterval(e)},[b,Z,C,n,j]);let E=(0,u.useMemo)(()=>{let e=Math.floor(P/1e3),n=String(Math.floor(e/60)).padStart(2,"0"),t=String(e%60).padStart(2,"0");return"".concat(n,":").concat(t)},[P]),L=(0,c.D)({mutationFn:()=>(0,x.VP)({type:"register"===t?"register":"login",email:null!=y?y:"",code:I}),onSuccess:e=>{var t;let i=e.user?{id:e.user.id,email:e.user.email,role:e.user.role,firstName:e.user.firstName,lastName:e.user.lastName,picture:null!==(t=e.user.picture)&&void 0!==t?t:null}:{id:"",email:null!=y?y:"",role:"admin",firstName:null==k?void 0:k.split(" ")[0],lastName:null==k?void 0:k.split(" ").slice(1).join(" ")};v(e.token,i),S({...i}),(0,m.bA)({action:"Logged in"}),n.push("/dashboard")}}),O=(0,u.useCallback)(()=>{y&&n.push("/")},[y,n]),_=(0,u.useCallback)((e,n)=>(0,i.jsx)("input",{...e,style:{width:56,height:56,textAlign:"center",fontSize:20,fontWeight:600,border:"none",borderRadius:8,backgroundColor:"#f2f2f2",outline:"none"}}),[]);return(0,i.jsx)(g.Z,{children:(0,i.jsxs)(r.Z,{spacing:3,sx:{width:"100%",alignItems:"center"},children:[(0,i.jsxs)(s.Z,{children:[(0,i.jsx)(a.Z,{variant:"h4",children:"OTP"}),(0,i.jsx)(a.Z,{variant:"body2",sx:{color:"text.secondary"},children:"We've sent you a 4-digit code to your email."})]}),(0,i.jsx)(s.Z,{component:"form",onSubmit:e=>{e.preventDefault(),y&&4===I.length&&L.mutate()},children:(0,i.jsxs)(r.Z,{spacing:3,alignItems:"center",children:[(0,i.jsx)(h.Z,{value:I,onChange:w,numInputs:4,renderInput:_,inputType:"number",shouldAutoFocus:!0,containerStyle:{gap:12}}),(0,i.jsxs)(r.Z,{direction:"row",spacing:2,alignItems:"center",children:[(0,i.jsxs)(a.Z,{variant:"body2",color:"text.secondary",children:["Code expires in ",E]}),(0,i.jsx)(l.Z,{variant:"text",color:"secondary",size:"small",onClick:O,children:"Send again"})]}),L.isError?(0,i.jsx)(o.Z,{severity:"error",children:L.error.message}):null,(0,i.jsx)(l.Z,{type:"submit",variant:"contained",size:"large",disabled:L.isPending||4!==I.length,sx:{backgroundColor:"#0b7b4c"},children:L.isPending?"Verifying...":"Confirm"})]})})]})})}function b(){return(0,i.jsx)(u.Suspense,{fallback:(0,i.jsx)(g.Z,{children:(0,i.jsx)(s.Z,{sx:{py:4,textAlign:"center"},children:(0,i.jsx)(a.Z,{color:"text.secondary",children:"Loading..."})})}),children:(0,i.jsx)(y,{})})}},2603:function(e,n,t){"use strict";t.d(n,{Z:function(){return l}});var i=t(7437),r=t(1899),s=t(4236);function a(){return(0,i.jsx)(r.Z,{component:s.E.div,initial:{backgroundPosition:"0% 50%"},animate:{backgroundPosition:["0% 50%","100% 50%","0% 50%"]},transition:{duration:7,repeat:1/0,ease:"linear"},sx:{position:"relative",display:{xs:"none",md:"flex"},alignItems:"center",justifyContent:"center",backgroundImage:"linear-gradient(135deg, #f0b12a 0%, #0b7b4c 55%, #f0b12a 100%)",backgroundSize:"200% 200%"},children:(0,i.jsx)(r.Z,{component:s.E.img,src:"/assets/svg/STILL PLAYLOGOWH.svg",alt:"Still Play",initial:{opacity:0,y:12,scale:.98},animate:{opacity:1,y:0,scale:1},transition:{duration:.6,ease:"easeOut"},sx:{width:{xs:140,md:180},height:"auto"}})})}function l(e){let{children:n}=e;return(0,i.jsx)(r.Z,{sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",padding:0},children:(0,i.jsxs)(r.Z,{sx:{width:"100%",minHeight:"100vh",background:"#fff",borderRadius:0,overflow:"hidden",display:"grid",gridTemplateColumns:{xs:"1fr",md:"40% 60%"}},children:[(0,i.jsx)(a,{}),(0,i.jsx)(r.Z,{sx:{padding:{xs:3,md:6},display:"flex",alignItems:"center",justifyContent:"center"},children:(0,i.jsx)(r.Z,{component:s.E.div,initial:{opacity:0,y:16},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},sx:{width:"100%",maxWidth:680},children:n})})]})})}}},function(e){e.O(0,[165,43,262,49,135,713,9,94,971,117,744],function(){return e(e.s=2592)}),_N_E=e.O()}]);