(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[672],{64340:function(e,n,t){Promise.resolve().then(t.bind(t,43830))},43830:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return F}});var r=t(57437),l=t(41554),a=t(95784),i=t(1899),s=t(8984),o=t(5002),u=t(59832),d=t(94013),c=t(35389),m=t(53392),x=t(79507),f=t(77468),y=t(97404),p=t(41327),h=t(10020),v=t(97414),b=t(98987),g=t(82279),j=t(9026),Z=t(2265),k=t(99376),q=t(44236),C=t(8243),N=t(58094),K=t(9099),w=t(53675);function F(){let e=(0,k.useRouter)(),n=(0,K.t)(e=>e.token),[t,F]=(0,Z.useState)(""),[S,L]=(0,Z.useState)(!1),[W,R]=(0,Z.useState)(""),[Q,I]=(0,Z.useState)(""),[T,E]=(0,Z.useState)(""),[O,D]=(0,Z.useState)(""),[A,z]=(0,Z.useState)(w.jY[0]),{data:B=[],isLoading:P,isError:Y,error:X,refetch:_,isFetching:H}=(0,N.OL)(),J=(0,N.Cx)();(0,Z.useEffect)(()=>{Y&&!n&&e.replace("/")},[Y,n,e]);let M=(0,Z.useMemo)(()=>{if(!t.trim())return B;let e=t.trim().toLowerCase();return B.filter(n=>{var t,r,l,a,i;return(null===(t=n.firstName)||void 0===t?void 0:t.toLowerCase().includes(e))||(null===(r=n.lastName)||void 0===r?void 0:r.toLowerCase().includes(e))||(null===(l=n.email)||void 0===l?void 0:l.toLowerCase().includes(e))||(null===(a=n.employeeNumber)||void 0===a?void 0:a.toLowerCase().includes(e))||(null===(i=n.role)||void 0===i?void 0:i.toLowerCase().includes(e))})},[B,t]),G=()=>{R(""),I(""),E(""),D(""),z(w.jY[0]),L(!1)};return(0,r.jsxs)(i.Z,{component:q.E.div,initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{duration:.45,ease:"easeOut"},children:[(0,r.jsx)(C.Z,{search:t,onSearchChange:F}),(0,r.jsx)(i.Z,{sx:{background:"#ffffff",borderRadius:{xs:0,md:2},padding:{xs:2,md:3.5},paddingBottom:{xs:3,md:4},marginTop:{xs:2,md:3},marginX:{xs:-2,md:0},minHeight:"calc(100vh - 220px)",display:"flex",flexDirection:"column"},children:(0,r.jsx)(s.Z,{spacing:2,children:(0,r.jsxs)(i.Z,{sx:{borderRadius:3,padding:2,backgroundColor:"#f3f3f3",display:"flex",flexDirection:"column"},children:[(0,r.jsxs)(s.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:1,sx:{marginBottom:2,paddingTop:2,paddingLeft:{xs:1,md:2}},children:[(0,r.jsx)(o.Z,{variant:"h6",sx:{fontWeight:700,fontSize:{xs:"1rem",md:"1.25rem"}},children:"STAFF"}),(0,r.jsxs)(s.Z,{direction:"row",spacing:1,flexWrap:"wrap",children:[(0,r.jsx)(u.Z,{size:"small",onClick:()=>_(),disabled:H,"aria-label":"Refresh list",children:(0,r.jsx)(a.Z,{})}),(0,r.jsx)(d.Z,{variant:"contained",size:"small",startIcon:(0,r.jsx)(l.Z,{}),onClick:()=>L(!0),sx:{backgroundColor:"#0b7b4c"},children:"Create Admin Account"})]})]}),(0,r.jsxs)(i.Z,{sx:{fontSize:12,color:"text.secondary",marginBottom:2,backgroundColor:"#fff",borderRadius:999,paddingY:1.2,paddingX:3,display:{xs:"none",md:"grid"},gridTemplateColumns:{md:"1.5fr 1.2fr 0.9fr 1.2fr 0.6fr"},alignItems:"center",gap:1},children:[(0,r.jsx)(i.Z,{children:"Name"}),(0,r.jsx)(i.Z,{children:"Email"}),(0,r.jsx)(i.Z,{children:"Employee #"}),(0,r.jsx)(i.Z,{children:"Role"}),(0,r.jsx)(i.Z,{children:"Status"})]}),(0,r.jsx)(i.Z,{sx:{marginTop:1,overflowX:{xs:"auto",md:"visible"},overflowY:{xs:"auto",md:"visible"},maxHeight:{xs:"70vh",md:"none"},WebkitOverflowScrolling:"touch"},children:P?(0,r.jsxs)(s.Z,{alignItems:"center",py:4,children:[(0,r.jsx)(c.Z,{sx:{color:"#0b7b4c"}}),(0,r.jsx)(o.Z,{variant:"body2",color:"text.secondary",sx:{mt:2},children:"Loading staff..."})]}):Y?(0,r.jsxs)(s.Z,{alignItems:"center",py:4,spacing:2,children:[(0,r.jsx)(o.Z,{color:"error",children:X.message}),(0,r.jsx)(d.Z,{variant:"outlined",onClick:()=>_(),size:"small",children:"Retry"})]}):0===M.length?(0,r.jsx)(o.Z,{color:"text.secondary",sx:{py:4,textAlign:"center"},children:"No staff yet. Create an admin account to get started."}):(0,r.jsx)(s.Z,{spacing:{xs:1.5,md:0},children:M.map(e=>{var n,t,l,a,s,u;return(0,r.jsxs)(i.Z,{sx:{paddingY:{xs:1.5,md:2},paddingX:{xs:2,md:3},borderBottom:{xs:"none",md:"1px solid #fff"},display:{xs:"block",md:"grid"},gridTemplateColumns:{md:"1.5fr 1.2fr 0.9fr 1.2fr 0.6fr"},alignItems:{md:"center"},gap:{md:1},backgroundColor:"#ffffff",borderRadius:{xs:2,md:1},border:{xs:"1px solid",md:"none"},borderColor:{xs:"divider",md:"transparent"},"&:hover":{backgroundColor:"#fafafa"}},children:[(0,r.jsxs)(i.Z,{sx:{display:{xs:"grid",md:"none"},gridTemplateColumns:"100px 1fr",gap:"4px 12px",alignItems:"baseline","& > .label":{color:"text.secondary",fontSize:"0.75rem"},"& > .value":{fontSize:"0.875rem",wordBreak:"break-word"}},children:[(0,r.jsx)("span",{className:"label",children:"Name"}),(0,r.jsx)("span",{className:"value",style:{fontWeight:600},children:[e.firstName,e.lastName].filter(Boolean).join(" ")||"—"}),(0,r.jsx)("span",{className:"label",children:"Email"}),(0,r.jsx)("span",{className:"value",children:null!==(n=e.email)&&void 0!==n?n:"—"}),(0,r.jsx)("span",{className:"label",children:"Employee #"}),(0,r.jsx)("span",{className:"value",children:null!==(t=e.employeeNumber)&&void 0!==t?t:"—"}),(0,r.jsx)("span",{className:"label",children:"Role"}),(0,r.jsx)("span",{className:"value",children:null!==(l=e.role)&&void 0!==l?l:"—"}),(0,r.jsx)("span",{className:"label",children:"Status"}),(0,r.jsx)("span",{className:"value",style:{color:e.active?"#0b7b4c":void 0,fontWeight:500},children:e.active?"Active":"Inactive"})]}),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.Z,{sx:{display:{xs:"none",md:"block"}},children:(0,r.jsx)(o.Z,{variant:"body2",fontWeight:600,children:[e.firstName,e.lastName].filter(Boolean).join(" ")||"—"})}),(0,r.jsx)(i.Z,{sx:{display:{xs:"none",md:"block"}},children:(0,r.jsx)(o.Z,{variant:"body2",color:"text.secondary",children:null!==(a=e.email)&&void 0!==a?a:"—"})}),(0,r.jsx)(i.Z,{sx:{display:{xs:"none",md:"block"}},children:(0,r.jsx)(o.Z,{variant:"body2",color:"text.secondary",children:null!==(s=e.employeeNumber)&&void 0!==s?s:"—"})}),(0,r.jsx)(i.Z,{sx:{display:{xs:"none",md:"block"}},children:(0,r.jsx)(o.Z,{variant:"body2",children:null!==(u=e.role)&&void 0!==u?u:"—"})}),(0,r.jsx)(i.Z,{sx:{display:{xs:"none",md:"block"}},children:(0,r.jsx)(o.Z,{variant:"body2",sx:{color:e.active?"#0b7b4c":"text.secondary",fontWeight:500},children:e.active?"Active":"Inactive"})})]})]},e.id)})})})]})})}),(0,r.jsxs)(m.Z,{open:S,onClose:G,PaperProps:{sx:{borderRadius:2}},maxWidth:"sm",fullWidth:!0,children:[(0,r.jsx)(x.Z,{children:"Create Admin Account"}),(0,r.jsx)(f.Z,{children:(0,r.jsxs)(s.Z,{spacing:2,sx:{pt:1},children:[(0,r.jsx)(y.Z,{label:"First name",required:!0,fullWidth:!0,value:W,onChange:e=>R(e.target.value),placeholder:"Jane"}),(0,r.jsx)(y.Z,{label:"Last name",required:!0,fullWidth:!0,value:Q,onChange:e=>I(e.target.value),placeholder:"Doe"}),(0,r.jsx)(y.Z,{label:"Email",type:"email",required:!0,fullWidth:!0,value:T,onChange:e=>E(e.target.value),placeholder:"admin@example.com"}),(0,r.jsx)(y.Z,{label:"Password",type:"password",required:!0,fullWidth:!0,value:O,onChange:e=>D(e.target.value),placeholder:"••••••••"}),(0,r.jsxs)(p.Z,{fullWidth:!0,required:!0,children:[(0,r.jsx)(h.Z,{id:"staff-role-label",children:"Role"}),(0,r.jsx)(v.Z,{labelId:"staff-role-label",value:A,label:"Role",onChange:e=>z(e.target.value),children:w.jY.map(e=>(0,r.jsx)(b.Z,{value:e,children:e},e))})]}),J.isError&&(0,r.jsx)(g.Z,{severity:"error",children:J.error.message})]})}),(0,r.jsxs)(j.Z,{sx:{px:3,pb:2},children:[(0,r.jsx)(d.Z,{onClick:G,children:"Cancel"}),(0,r.jsx)(d.Z,{variant:"contained",onClick:()=>{let e=W.trim(),n=Q.trim(),t=T.trim();e&&n&&t&&O&&J.mutate({firstName:e,lastName:n,email:t,password:O,role:A},{onSuccess:()=>G()})},disabled:!W.trim()||!Q.trim()||!T.trim()||!O||J.isPending,sx:{backgroundColor:"#0b7b4c"},children:J.isPending?"Creating...":"Create"})]})]})]})}},8243:function(e,n,t){"use strict";t.d(n,{Z:function(){return u}});var r=t(57437),l=t(59869),a=t(8984),i=t(97404),s=t(23996),o=t(1899);function u(e){let{search:n,onSearchChange:t}=e;return(0,r.jsxs)(a.Z,{direction:{xs:"column",md:"row"},alignItems:{xs:"stretch",md:"center"},justifyContent:"space-between",spacing:2,sx:{marginBottom:3},children:[(0,r.jsx)(i.Z,{placeholder:"Search",value:n,onChange:e=>t(e.target.value),InputProps:{startAdornment:(0,r.jsx)(s.Z,{position:"start",children:(0,r.jsx)(l.Z,{sx:{color:"#97a6a0"}})})},sx:{width:{xs:"100%",sm:320,md:380},alignSelf:{xs:"stretch",md:"flex-start"},"& .MuiOutlinedInput-root":{backgroundColor:"#f3f3f3",borderRadius:999,"& fieldset":{border:"none"},"&:hover fieldset":{border:"none"},"&.Mui-focused fieldset":{border:"none"}}}}),(0,r.jsx)(o.Z,{})]})}},58094:function(e,n,t){"use strict";t.d(n,{Cx:function(){return b},HI:function(){return Z},Hv:function(){return F},It:function(){return j},OL:function(){return v},P7:function(){return k},RB:function(){return N},Rm:function(){return d},XO:function(){return c},Xl:function(){return C},Y7:function(){return y},Yn:function(){return S},bA:function(){return f},cy:function(){return K},ez:function(){return h},hV:function(){return m},ko:function(){return p},l2:function(){return g},pv:function(){return q},ur:function(){return w},yf:function(){return x}});var r=t(11713),l=t(29827),a=t(21770),i=t(9099),s=t(53675);let o={all:["admin"],users:()=>[...o.all,"users"],user:e=>[...o.users(),e],employees:()=>[...o.all,"employees"],activity:()=>[...o.all,"activity"],settings:()=>[...o.all,"settings"],loans:{all:()=>[...o.all,"loans","all"],allRepayments:()=>[...o.all,"loans","repayments","all"],userLoans:e=>[...o.all,"loans","user",e],userRepayments:e=>[...o.all,"loans","repayments","user",e],userWallet:e=>[...o.all,"loans","wallet",e],userEligibility:e=>[...o.all,"loans","eligibility",e]}},u={all:["providers"],list:()=>[...u.all,"list"]};function d(){let e=(0,i.t)(e=>e.token);return(0,r.a)({queryKey:o.users(),queryFn:()=>(0,s.zO)(e),enabled:!!e,refetchOnWindowFocus:!0,staleTime:6e4})}function c(e){let n=(0,i.t)(e=>e.token);return(0,r.a)({queryKey:[...o.users(),"detail",e],queryFn:()=>(0,s.eJ)(n,e),enabled:!!n&&!!e,staleTime:3e4})}function m(){let e=(0,i.t)(e=>e.token),n=(0,l.NL)();return(0,a.D)({mutationFn:n=>{let{id:t,payload:r}=n;return(0,s.vr)(e,t,r)},onSuccess:()=>{n.invalidateQueries({queryKey:o.users()}),f({action:"User edited"}),n.invalidateQueries({queryKey:o.activity()})}})}function x(e){let n=(0,i.t)(e=>e.token);return(0,r.a)({queryKey:[...o.activity(),null!=e?e:50],queryFn:()=>(0,s.Cy)(n,e),enabled:!!n,staleTime:3e4})}function f(e){let n=i.t.getState().token;n&&(0,s.BX)(n,e).catch(()=>{})}function y(){let e=(0,i.t)(e=>e.token),n=(0,l.NL)();return(0,a.D)({mutationFn:n=>(0,s.Er)(e,n),onSuccess:()=>{n.invalidateQueries({queryKey:o.users()}),f({action:"User deleted"}),n.invalidateQueries({queryKey:o.activity()})}})}function p(){let e=(0,i.t)(e=>e.token);return(0,r.a)({queryKey:u.list(),queryFn:()=>(0,s.xp)(e),enabled:!!e,refetchOnWindowFocus:!0,staleTime:6e4})}function h(){let e=(0,i.t)(e=>e.token),n=(0,l.NL)();return(0,a.D)({mutationFn:n=>(0,s.Qz)(e,n),onSuccess:()=>{n.invalidateQueries({queryKey:u.list()}),f({action:"Provider added"}),n.invalidateQueries({queryKey:o.activity()})}})}function v(){let e=(0,i.t)(e=>e.token);return(0,r.a)({queryKey:o.employees(),queryFn:()=>(0,s.vG)(e),enabled:!!e,refetchOnWindowFocus:!0,staleTime:6e4})}function b(){let e=(0,i.t)(e=>e.token),n=(0,l.NL)();return(0,a.D)({mutationFn:n=>(0,s.r8)(e,n),onSuccess:()=>{n.invalidateQueries({queryKey:o.employees()}),f({action:"Staff/employee created"}),n.invalidateQueries({queryKey:o.activity()})}})}function g(e){let n=(0,i.t)(e=>e.token);return(0,r.a)({queryKey:o.loans.userLoans(null!=e?e:""),queryFn:()=>(0,s.hJ)(n,e),enabled:!!n&&!!e,staleTime:3e4})}function j(e){let n=(0,i.t)(e=>e.token);return(0,r.a)({queryKey:o.loans.userRepayments(null!=e?e:""),queryFn:()=>(0,s.Rt)(n,e),enabled:!!n&&!!e,staleTime:3e4})}function Z(e){let n=(0,i.t)(e=>e.token);return(0,r.a)({queryKey:o.loans.userWallet(null!=e?e:""),queryFn:()=>(0,s.p0)(n,e),enabled:!!n&&!!e,staleTime:3e4})}function k(e){let n=(0,i.t)(e=>e.token);return(0,r.a)({queryKey:o.loans.userEligibility(null!=e?e:""),queryFn:()=>(0,s.Hd)(n,e),enabled:!!n&&!!e,staleTime:15e3})}function q(){let e=(0,i.t)(e=>e.token),n=(0,l.NL)();return(0,a.D)({mutationFn:n=>(0,s.G7)(e,n),onSuccess:(e,t)=>{n.invalidateQueries({queryKey:o.loans.userLoans(t.userId)}),n.invalidateQueries({queryKey:o.loans.userWallet(t.userId)}),n.invalidateQueries({queryKey:o.loans.userRepayments(t.userId)}),n.invalidateQueries({queryKey:o.loans.userEligibility(t.userId)}),n.invalidateQueries({queryKey:o.loans.all()}),n.invalidateQueries({queryKey:o.loans.allRepayments()})}})}function C(){let e=(0,i.t)(e=>e.token);return(0,r.a)({queryKey:o.loans.all(),queryFn:()=>(0,s.cA)(e),enabled:!!e,refetchOnWindowFocus:!0,staleTime:3e4})}function N(){let e=(0,i.t)(e=>e.token);return(0,r.a)({queryKey:o.loans.allRepayments(),queryFn:()=>(0,s.Cb)(e),enabled:!!e,refetchOnWindowFocus:!0,staleTime:3e4})}function K(){let e=(0,i.t)(e=>e.token),n=(0,l.NL)();return(0,a.D)({mutationFn:n=>(0,s.xl)(e,n),onSuccess:()=>{n.invalidateQueries({queryKey:o.loans.all()}),f({action:"Loan approved"}),n.invalidateQueries({queryKey:o.activity()})}})}function w(){let e=(0,i.t)(e=>e.token),n=(0,l.NL)();return(0,a.D)({mutationFn:n=>(0,s.ey)(e,n),onSuccess:()=>{n.invalidateQueries({queryKey:o.loans.all()}),f({action:"Loan rejected"}),n.invalidateQueries({queryKey:o.activity()})}})}function F(){let e=(0,i.t)(e=>e.token);return(0,r.a)({queryKey:o.settings(),queryFn:()=>(0,s.hO)(e),enabled:!!e,staleTime:6e4})}function S(){let e=(0,i.t)(e=>e.token),n=(0,l.NL)();return(0,a.D)({mutationFn:n=>{let{key:t,value:r}=n;return(0,s.WD)(e,t,r)},onSuccess:()=>{n.invalidateQueries({queryKey:o.settings()})}})}}},function(e){e.O(0,[515,330,262,666,140,404,236,713,857,270,757,675,971,117,744],function(){return e(e.s=64340)}),_N_E=e.O()}]);