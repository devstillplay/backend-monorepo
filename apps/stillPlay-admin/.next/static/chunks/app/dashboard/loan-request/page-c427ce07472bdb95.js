(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[15],{39705:function(e,n,t){Promise.resolve().then(t.bind(t,35183))},35183:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return p}});var r=t(57437),i=t(39107),s=t(95784),l=t(1899),a=t(8984),o=t(5002),u=t(59832),c=t(35389),d=t(94013),m=t(67116),x=t(36476),f=t(2265),y=t(8243),h=t(58094);function p(){var e;let[n,t]=(0,f.useState)(""),[p,g]=(0,f.useState)(1),[v,b]=(0,f.useState)("all"),{data:j,isLoading:Z,isError:k,error:q,refetch:C,isFetching:K}=(0,h.Xl)(),{data:w=[]}=(0,h.Rm)(),S=(0,h.cy)(),I=(0,h.ur)(),R=null!==(e=null==j?void 0:j.loans)&&void 0!==e?e:[],N=(0,f.useMemo)(()=>{let e=new Map;return w.forEach(n=>{var t,r;let i=[n.firstName,n.lastName].filter(Boolean).join(" ")||n.email||"—";e.set(n.id,{name:i,code:null!==(t=n.userNumber)&&void 0!==t?t:n.id.slice(-6),picture:null!==(r=n.picture)&&void 0!==r?r:null})}),e},[w]),T=(0,f.useMemo)(()=>{let e=R;if("all"!==v&&(e=e.filter(e=>e.status===v)),n.trim()){let t=n.trim().toLowerCase();e=e.filter(e=>{let n=N.get(e.userId);return(null==n?void 0:n.name.toLowerCase().includes(t))||(null==n?void 0:n.code.toLowerCase().includes(t))||e.amount.toString().includes(t)||e.id.toLowerCase().includes(t)})}return e},[R,v,n,N]),F=Math.max(1,Math.ceil(T.length/10)),L=(p-1)*10,E=T.slice(L,L+10);return(0,r.jsxs)(l.Z,{children:[(0,r.jsx)(y.Z,{search:n,onSearchChange:t}),(0,r.jsx)(l.Z,{sx:{background:"#ffffff",borderRadius:{xs:0,md:4},padding:{xs:2,md:3.5},paddingBottom:{xs:3,md:4},marginTop:{xs:2,md:3},marginX:{xs:-2,md:0},minHeight:"calc(100vh - 220px)",display:"flex",flexDirection:"column"},children:(0,r.jsx)(a.Z,{sx:{marginTop:"auto"},spacing:2,children:(0,r.jsxs)(l.Z,{sx:{borderRadius:3,padding:2,backgroundColor:"#f3f3f3",display:"flex",flexDirection:"column"},children:[(0,r.jsxs)(a.Z,{spacing:2,sx:{marginBottom:2,paddingTop:2,paddingLeft:{xs:1,md:2}},children:[(0,r.jsxs)(a.Z,{direction:"row",alignItems:"center",spacing:1,flexWrap:"wrap",children:[(0,r.jsx)(o.Z,{variant:"h6",sx:{fontWeight:700,fontSize:{xs:"1rem",md:"1.25rem"}},children:"LOAN REQUEST"}),(0,r.jsx)(u.Z,{size:"small",onClick:()=>C(),disabled:K,"aria-label":"Refresh",children:(0,r.jsx)(s.Z,{fontSize:"small"})})]}),(0,r.jsx)(a.Z,{direction:"row",spacing:{xs:1,md:4},alignItems:"center",flexWrap:"wrap",sx:{gap:{xs:.5,md:0}},children:["all","PENDING","APPROVED","REJECTED","DISBURSED","REPAID"].map(e=>(0,r.jsxs)(o.Z,{variant:"body2",onClick:()=>b(e),sx:{cursor:"pointer",color:v===e?"#0b7b4c":"text.secondary",fontWeight:v===e?600:400,position:"relative",paddingBottom:.5},children:["all"===e?"All request":e,v===e&&(0,r.jsx)(l.Z,{component:"span",sx:{position:"absolute",left:0,right:0,bottom:0,height:2,backgroundColor:"#0b7b4c",borderRadius:999}})]},e))})]}),(0,r.jsxs)(l.Z,{sx:{fontSize:12,color:"text.secondary",marginBottom:2,backgroundColor:"#fff",borderRadius:999,paddingY:1.2,paddingX:3,display:{xs:"none",md:"grid"},gridTemplateColumns:"1.2fr 1.6fr 1fr 1fr 1fr 1.2fr",alignItems:"center",gap:1},children:[(0,r.jsx)(l.Z,{children:"Offline code"}),(0,r.jsx)(l.Z,{children:"Name"}),(0,r.jsx)(l.Z,{children:"Amount"}),(0,r.jsx)(l.Z,{children:"Time"}),(0,r.jsx)(l.Z,{children:"Status"}),(0,r.jsx)(l.Z,{children:"Actions"})]}),(0,r.jsx)(l.Z,{sx:{marginTop:1,maxHeight:{xs:420,sm:"none"},overflowY:{xs:"auto",sm:"visible"}},children:Z?(0,r.jsxs)(a.Z,{alignItems:"center",py:4,children:[(0,r.jsx)(c.Z,{sx:{color:"#0b7b4c"}}),(0,r.jsx)(o.Z,{variant:"body2",color:"text.secondary",sx:{mt:2},children:"Loading loans..."})]}):k?(0,r.jsxs)(a.Z,{alignItems:"center",py:4,spacing:2,children:[(0,r.jsx)(o.Z,{color:"error",children:q.message}),(0,r.jsx)(d.Z,{variant:"outlined",onClick:()=>C(),size:"small",children:"Retry"})]}):(0,r.jsxs)(a.Z,{spacing:0,children:[E.map((e,n)=>{var t,s,u;let c=N.get(e.userId),x=null!==(t=null==c?void 0:c.name)&&void 0!==t?t:"—",f=null!==(s=null==c?void 0:c.code)&&void 0!==s?s:e.userId.slice(-6),y=e.createdAt?new Date(e.createdAt).toLocaleTimeString("en-NG",{hour:"2-digit",minute:"2-digit"}):"—",h="PENDING"===e.status,p=S.isPending&&S.variables===e.id,g=I.isPending&&I.variables===e.id;return(0,r.jsxs)(l.Z,{sx:{paddingY:{xs:1.5,md:2},paddingX:{xs:2,md:3},borderBottom:n===E.length-1?"none":"1px solid #fff",backgroundColor:0===n?"#ffffff":"transparent",display:"grid",gridTemplateColumns:{xs:"1fr 1fr",md:"1.2fr 1.6fr 1fr 1fr 1fr 1.2fr"},alignItems:"center",gap:{xs:1,md:1},borderRadius:1},children:[(0,r.jsxs)(l.Z,{children:[(0,r.jsx)(o.Z,{variant:"caption",color:"text.secondary",sx:{display:{xs:"block",md:"none"}},children:"Code"}),(0,r.jsxs)(o.Z,{variant:"body2",sx:{fontWeight:600},children:["#",f]})]}),(0,r.jsxs)(l.Z,{children:[(0,r.jsx)(o.Z,{variant:"caption",color:"text.secondary",sx:{display:{xs:"block",md:"none"}},children:"Name"}),(0,r.jsxs)(a.Z,{direction:"row",spacing:1,alignItems:"center",children:[(0,r.jsx)(m.Z,{src:(null==c?void 0:c.picture)||void 0,sx:{width:32,height:32},children:(null!==(u=null==x?void 0:x[0])&&void 0!==u?u:"?").toUpperCase()}),(0,r.jsx)(o.Z,{variant:"body2",children:x})]})]}),(0,r.jsxs)(l.Z,{sx:{gridColumn:{xs:"1",md:"auto"}},children:[(0,r.jsx)(o.Z,{variant:"caption",color:"text.secondary",sx:{display:{xs:"block",md:"none"}},children:"Amount"}),(0,r.jsxs)(o.Z,{variant:"body2",children:["NGN ",Number(e.amount).toLocaleString()]})]}),(0,r.jsxs)(l.Z,{children:[(0,r.jsx)(o.Z,{variant:"caption",color:"text.secondary",sx:{display:{xs:"block",md:"none"}},children:"Time"}),(0,r.jsxs)(a.Z,{direction:"row",spacing:1,alignItems:"center",children:[(0,r.jsx)(i.Z,{sx:{fontSize:18,color:"#6b6b6b"}}),(0,r.jsx)(o.Z,{variant:"body2",children:y})]})]}),(0,r.jsxs)(l.Z,{sx:{gridColumn:{xs:"2",md:"auto"}},children:[(0,r.jsx)(o.Z,{variant:"caption",color:"text.secondary",sx:{display:{xs:"block",md:"none"}},children:"Status"}),(0,r.jsxs)(a.Z,{direction:"row",spacing:1,alignItems:"center",children:[(0,r.jsx)(l.Z,{sx:{width:10,height:10,borderRadius:"50%",backgroundColor:function(e){switch(e){case"REPAID":return"#22c55e";case"REJECTED":return"#ef4444";default:return"#f59e0b"}}(e.status)}}),(0,r.jsx)(o.Z,{variant:"body2",children:e.status})]})]}),(0,r.jsxs)(a.Z,{direction:"row",spacing:1,alignItems:"center",sx:{gridColumn:{xs:"1 / -1",md:"auto"}},children:[(0,r.jsx)(d.Z,{size:"small",variant:"contained",disabled:!h||p||g,onClick:()=>S.mutate(e.id),sx:{backgroundColor:"#22c55e","&:hover":{backgroundColor:"#16a34a"}},children:p?"...":"Accept"}),(0,r.jsx)(d.Z,{size:"small",variant:"outlined",color:"error",disabled:!h||p||g,onClick:()=>I.mutate(e.id),children:g?"...":"Reject"})]})]},e.id)}),0===E.length&&(0,r.jsx)(o.Z,{variant:"body2",color:"text.secondary",sx:{py:4,textAlign:"center"},children:"No loans match the filter."})]})}),(0,r.jsx)(a.Z,{alignItems:"center",sx:{marginTop:2},children:(0,r.jsx)(x.Z,{count:F,page:p,onChange:(e,n)=>g(n),color:"primary"})})]})})})]})}},8243:function(e,n,t){"use strict";t.d(n,{Z:function(){return u}});var r=t(57437),i=t(59869),s=t(8984),l=t(97404),a=t(23996),o=t(1899);function u(e){let{search:n,onSearchChange:t}=e;return(0,r.jsxs)(s.Z,{direction:{xs:"column",md:"row"},alignItems:{xs:"stretch",md:"center"},justifyContent:"space-between",spacing:2,sx:{marginBottom:3},children:[(0,r.jsx)(l.Z,{placeholder:"Search",value:n,onChange:e=>t(e.target.value),InputProps:{startAdornment:(0,r.jsx)(a.Z,{position:"start",children:(0,r.jsx)(i.Z,{sx:{color:"#97a6a0"}})})},sx:{width:{xs:"100%",sm:320,md:380},alignSelf:{xs:"stretch",md:"flex-start"},"& .MuiOutlinedInput-root":{backgroundColor:"#f3f3f3",borderRadius:999,"& fieldset":{border:"none"},"&:hover fieldset":{border:"none"},"&.Mui-focused fieldset":{border:"none"}}}}),(0,r.jsx)(o.Z,{})]})}},58094:function(e,n,t){"use strict";t.d(n,{Cx:function(){return v},HI:function(){return Z},Hv:function(){return I},It:function(){return j},OL:function(){return g},P7:function(){return k},RB:function(){return K},Rm:function(){return c},XO:function(){return d},Xl:function(){return C},Y7:function(){return y},Yn:function(){return R},bA:function(){return f},cy:function(){return w},ez:function(){return p},hV:function(){return m},ko:function(){return h},l2:function(){return b},pv:function(){return q},ur:function(){return S},yf:function(){return x}});var r=t(11713),i=t(29827),s=t(21770),l=t(9099),a=t(53675);let o={all:["admin"],users:()=>[...o.all,"users"],user:e=>[...o.users(),e],employees:()=>[...o.all,"employees"],activity:()=>[...o.all,"activity"],settings:()=>[...o.all,"settings"],loans:{all:()=>[...o.all,"loans","all"],allRepayments:()=>[...o.all,"loans","repayments","all"],userLoans:e=>[...o.all,"loans","user",e],userRepayments:e=>[...o.all,"loans","repayments","user",e],userWallet:e=>[...o.all,"loans","wallet",e],userEligibility:e=>[...o.all,"loans","eligibility",e]}},u={all:["providers"],list:()=>[...u.all,"list"]};function c(){let e=(0,l.t)(e=>e.token);return(0,r.a)({queryKey:o.users(),queryFn:()=>(0,a.zO)(e),enabled:!!e,refetchOnWindowFocus:!0,staleTime:6e4})}function d(e){let n=(0,l.t)(e=>e.token);return(0,r.a)({queryKey:[...o.users(),"detail",e],queryFn:()=>(0,a.eJ)(n,e),enabled:!!n&&!!e,staleTime:3e4})}function m(){let e=(0,l.t)(e=>e.token),n=(0,i.NL)();return(0,s.D)({mutationFn:n=>{let{id:t,payload:r}=n;return(0,a.vr)(e,t,r)},onSuccess:()=>{n.invalidateQueries({queryKey:o.users()}),f({action:"User edited"}),n.invalidateQueries({queryKey:o.activity()})}})}function x(e){let n=(0,l.t)(e=>e.token);return(0,r.a)({queryKey:[...o.activity(),null!=e?e:50],queryFn:()=>(0,a.Cy)(n,e),enabled:!!n,staleTime:3e4})}function f(e){let n=l.t.getState().token;n&&(0,a.BX)(n,e).catch(()=>{})}function y(){let e=(0,l.t)(e=>e.token),n=(0,i.NL)();return(0,s.D)({mutationFn:n=>(0,a.Er)(e,n),onSuccess:()=>{n.invalidateQueries({queryKey:o.users()}),f({action:"User deleted"}),n.invalidateQueries({queryKey:o.activity()})}})}function h(){let e=(0,l.t)(e=>e.token);return(0,r.a)({queryKey:u.list(),queryFn:()=>(0,a.xp)(e),enabled:!!e,refetchOnWindowFocus:!0,staleTime:6e4})}function p(){let e=(0,l.t)(e=>e.token),n=(0,i.NL)();return(0,s.D)({mutationFn:n=>(0,a.Qz)(e,n),onSuccess:()=>{n.invalidateQueries({queryKey:u.list()}),f({action:"Provider added"}),n.invalidateQueries({queryKey:o.activity()})}})}function g(){let e=(0,l.t)(e=>e.token);return(0,r.a)({queryKey:o.employees(),queryFn:()=>(0,a.vG)(e),enabled:!!e,refetchOnWindowFocus:!0,staleTime:6e4})}function v(){let e=(0,l.t)(e=>e.token),n=(0,i.NL)();return(0,s.D)({mutationFn:n=>(0,a.r8)(e,n),onSuccess:()=>{n.invalidateQueries({queryKey:o.employees()}),f({action:"Staff/employee created"}),n.invalidateQueries({queryKey:o.activity()})}})}function b(e){let n=(0,l.t)(e=>e.token);return(0,r.a)({queryKey:o.loans.userLoans(null!=e?e:""),queryFn:()=>(0,a.hJ)(n,e),enabled:!!n&&!!e,staleTime:3e4})}function j(e){let n=(0,l.t)(e=>e.token);return(0,r.a)({queryKey:o.loans.userRepayments(null!=e?e:""),queryFn:()=>(0,a.Rt)(n,e),enabled:!!n&&!!e,staleTime:3e4})}function Z(e){let n=(0,l.t)(e=>e.token);return(0,r.a)({queryKey:o.loans.userWallet(null!=e?e:""),queryFn:()=>(0,a.p0)(n,e),enabled:!!n&&!!e,staleTime:3e4})}function k(e){let n=(0,l.t)(e=>e.token);return(0,r.a)({queryKey:o.loans.userEligibility(null!=e?e:""),queryFn:()=>(0,a.Hd)(n,e),enabled:!!n&&!!e,staleTime:15e3})}function q(){let e=(0,l.t)(e=>e.token),n=(0,i.NL)();return(0,s.D)({mutationFn:n=>(0,a.G7)(e,n),onSuccess:(e,t)=>{n.invalidateQueries({queryKey:o.loans.userLoans(t.userId)}),n.invalidateQueries({queryKey:o.loans.userWallet(t.userId)}),n.invalidateQueries({queryKey:o.loans.userRepayments(t.userId)}),n.invalidateQueries({queryKey:o.loans.userEligibility(t.userId)}),n.invalidateQueries({queryKey:o.loans.all()}),n.invalidateQueries({queryKey:o.loans.allRepayments()})}})}function C(){let e=(0,l.t)(e=>e.token);return(0,r.a)({queryKey:o.loans.all(),queryFn:()=>(0,a.cA)(e),enabled:!!e,refetchOnWindowFocus:!0,staleTime:3e4})}function K(){let e=(0,l.t)(e=>e.token);return(0,r.a)({queryKey:o.loans.allRepayments(),queryFn:()=>(0,a.Cb)(e),enabled:!!e,refetchOnWindowFocus:!0,staleTime:3e4})}function w(){let e=(0,l.t)(e=>e.token),n=(0,i.NL)();return(0,s.D)({mutationFn:n=>(0,a.xl)(e,n),onSuccess:()=>{n.invalidateQueries({queryKey:o.loans.all()}),f({action:"Loan approved"}),n.invalidateQueries({queryKey:o.activity()})}})}function S(){let e=(0,l.t)(e=>e.token),n=(0,i.NL)();return(0,s.D)({mutationFn:n=>(0,a.ey)(e,n),onSuccess:()=>{n.invalidateQueries({queryKey:o.loans.all()}),f({action:"Loan rejected"}),n.invalidateQueries({queryKey:o.activity()})}})}function I(){let e=(0,l.t)(e=>e.token);return(0,r.a)({queryKey:o.settings(),queryFn:()=>(0,a.hO)(e),enabled:!!e,staleTime:6e4})}function R(){let e=(0,l.t)(e=>e.token),n=(0,i.NL)();return(0,s.D)({mutationFn:n=>{let{key:t,value:r}=n;return(0,a.WD)(e,t,r)},onSuccess:()=>{n.invalidateQueries({queryKey:o.settings()})}})}},39107:function(e,n,t){"use strict";var r=t(9973);n.Z=void 0;var i=r(t(59815)),s=t(57437);n.Z=(0,i.default)((0,s.jsx)("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8m.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"}),"AccessTimeOutlined")}},function(e){e.O(0,[515,330,262,666,140,404,713,857,887,675,971,117,744],function(){return e(e.s=39705)}),_N_E=e.O()}]);