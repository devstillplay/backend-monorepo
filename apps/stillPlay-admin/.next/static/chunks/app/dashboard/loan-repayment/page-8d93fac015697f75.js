(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[244],{67502:function(e,n,t){Promise.resolve().then(t.bind(t,69136))},69136:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return h}});var r=t(57437),i=t(39107),s=t(95784),l=t(1899),a=t(8984),o=t(5002),u=t(59832),c=t(35389),d=t(94013),y=t(67116),m=t(36476),f=t(2265),x=t(8243),p=t(58094);function h(){var e;let[n,t]=(0,f.useState)(""),[h,g]=(0,f.useState)(1),{data:v,isLoading:b,isError:j,error:Z,refetch:q,isFetching:k}=(0,p.RB)(),{data:K=[]}=(0,p.Rm)(),C=null!==(e=null==v?void 0:v.repayments)&&void 0!==e?e:[],w=(0,f.useMemo)(()=>{let e=new Map;return K.forEach(n=>{var t;let r=[n.firstName,n.lastName].filter(Boolean).join(" ")||n.email||"—";e.set(n.id,{name:r,picture:null!==(t=n.picture)&&void 0!==t?t:null})}),e},[K]),F=(0,f.useMemo)(()=>{if(!n.trim())return C;let e=n.trim().toLowerCase();return C.filter(n=>{let t=w.get(n.userId);return(null==t?void 0:t.name.toLowerCase().includes(e))||n.amount.toString().includes(e)||n.id.toLowerCase().includes(e)||n.loanId.toLowerCase().includes(e)})},[C,n,w]),S=Math.max(1,Math.ceil(F.length/10)),T=(h-1)*10,L=F.slice(T,T+10);return(0,r.jsxs)(l.Z,{children:[(0,r.jsx)(x.Z,{search:n,onSearchChange:t}),(0,r.jsx)(l.Z,{sx:{background:"#ffffff",borderRadius:{xs:0,md:4},padding:{xs:2,md:3.5},paddingBottom:{xs:3,md:4},marginTop:{xs:2,md:3},marginX:{xs:-2,md:0},minHeight:"calc(100vh - 220px)",display:"flex",flexDirection:"column"},children:(0,r.jsx)(a.Z,{sx:{marginTop:"auto"},spacing:2,children:(0,r.jsxs)(l.Z,{sx:{borderRadius:3,padding:2,backgroundColor:"#f3f3f3",display:"flex",flexDirection:"column"},children:[(0,r.jsxs)(a.Z,{spacing:2,sx:{marginBottom:2,paddingTop:2,paddingLeft:{xs:1,md:2}},children:[(0,r.jsxs)(a.Z,{direction:"row",alignItems:"center",spacing:1,flexWrap:"wrap",children:[(0,r.jsx)(o.Z,{variant:"h6",sx:{fontWeight:700,fontSize:{xs:"1rem",md:"1.25rem"}},children:"REPAYMENT"}),(0,r.jsx)(u.Z,{size:"small",onClick:()=>q(),disabled:k,"aria-label":"Refresh",children:(0,r.jsx)(s.Z,{fontSize:"small"})})]}),(0,r.jsx)(a.Z,{direction:"row",spacing:4,alignItems:"center",children:(0,r.jsxs)(o.Z,{variant:"body2",sx:{color:"#0b7b4c",fontWeight:600,position:"relative",paddingBottom:.5},children:["All repayments",(0,r.jsx)(l.Z,{component:"span",sx:{position:"absolute",left:0,right:0,bottom:0,height:2,backgroundColor:"#0b7b4c",borderRadius:999}})]})})]}),(0,r.jsxs)(l.Z,{sx:{fontSize:12,color:"text.secondary",marginBottom:2,backgroundColor:"#fff",borderRadius:999,paddingY:1.2,paddingX:3,display:{xs:"none",md:"grid"},gridTemplateColumns:"2fr 1fr 1fr",alignItems:"center",gap:1},children:[(0,r.jsx)(l.Z,{children:"Name"}),(0,r.jsx)(l.Z,{children:"Amount"}),(0,r.jsx)(l.Z,{children:"Time"})]}),(0,r.jsx)(l.Z,{sx:{marginTop:1,maxHeight:{xs:420,sm:"none"},overflowY:{xs:"auto",sm:"visible"},overflowX:{xs:"auto",md:"visible"}},children:b?(0,r.jsxs)(a.Z,{alignItems:"center",py:4,children:[(0,r.jsx)(c.Z,{sx:{color:"#0b7b4c"}}),(0,r.jsx)(o.Z,{variant:"body2",color:"text.secondary",sx:{mt:2},children:"Loading repayments..."})]}):j?(0,r.jsxs)(a.Z,{alignItems:"center",py:4,spacing:2,children:[(0,r.jsx)(o.Z,{color:"error",children:Z.message}),(0,r.jsx)(d.Z,{variant:"outlined",onClick:()=>q(),size:"small",children:"Retry"})]}):(0,r.jsxs)(a.Z,{spacing:0,children:[L.map((e,n)=>{var t,s;let u=w.get(e.userId),c=null!==(t=null==u?void 0:u.name)&&void 0!==t?t:"—",d=e.repaidAt?new Date(e.repaidAt).toLocaleString("en-NG",{dateStyle:"short",timeStyle:"short"}):"—";return(0,r.jsxs)(l.Z,{sx:{paddingY:{xs:1.5,md:2},paddingX:{xs:2,md:3},borderBottom:n===L.length-1?"none":"1px solid #fff",display:"grid",gridTemplateColumns:{xs:"1fr 1fr",md:"2fr 1fr 1fr"},alignItems:"center",gap:{xs:1,md:1},borderRadius:1},children:[(0,r.jsxs)(l.Z,{sx:{gridColumn:{xs:"1 / -1",md:"auto"}},children:[(0,r.jsx)(o.Z,{variant:"caption",color:"text.secondary",sx:{display:{xs:"block",md:"none"}},children:"Name"}),(0,r.jsxs)(a.Z,{direction:"row",spacing:2,alignItems:"center",children:[(0,r.jsx)(y.Z,{src:(null==u?void 0:u.picture)||void 0,sx:{width:36,height:36},children:(null!==(s=null==c?void 0:c[0])&&void 0!==s?s:"?").toUpperCase()}),(0,r.jsx)(o.Z,{variant:"body2",children:c})]})]}),(0,r.jsxs)(l.Z,{children:[(0,r.jsx)(o.Z,{variant:"caption",color:"text.secondary",sx:{display:{xs:"block",md:"none"}},children:"Amount"}),(0,r.jsxs)(o.Z,{variant:"body2",children:["NGN ",Number(e.amount).toLocaleString()]})]}),(0,r.jsxs)(l.Z,{sx:{gridColumn:{xs:"2",md:"auto"}},children:[(0,r.jsx)(o.Z,{variant:"caption",color:"text.secondary",sx:{display:{xs:"block",md:"none"}},children:"Time"}),(0,r.jsxs)(a.Z,{direction:"row",spacing:1,alignItems:"center",children:[(0,r.jsx)(i.Z,{sx:{fontSize:18,color:"#6b6b6b"}}),(0,r.jsx)(o.Z,{variant:"body2",children:d})]})]})]},e.id)}),0===L.length&&(0,r.jsx)(o.Z,{variant:"body2",color:"text.secondary",sx:{py:4,textAlign:"center"},children:"No repayments yet."})]})}),(0,r.jsx)(a.Z,{alignItems:"center",sx:{marginTop:2},children:(0,r.jsx)(m.Z,{count:S,page:h,onChange:(e,n)=>g(n),color:"primary"})})]})})})]})}},8243:function(e,n,t){"use strict";t.d(n,{Z:function(){return u}});var r=t(57437),i=t(59869),s=t(8984),l=t(97404),a=t(23996),o=t(1899);function u(e){let{search:n,onSearchChange:t}=e;return(0,r.jsxs)(s.Z,{direction:{xs:"column",md:"row"},alignItems:{xs:"stretch",md:"center"},justifyContent:"space-between",spacing:2,sx:{marginBottom:3},children:[(0,r.jsx)(l.Z,{placeholder:"Search",value:n,onChange:e=>t(e.target.value),InputProps:{startAdornment:(0,r.jsx)(a.Z,{position:"start",children:(0,r.jsx)(i.Z,{sx:{color:"#97a6a0"}})})},sx:{width:{xs:"100%",sm:320,md:380},alignSelf:{xs:"stretch",md:"flex-start"},"& .MuiOutlinedInput-root":{backgroundColor:"#f3f3f3",borderRadius:999,"& fieldset":{border:"none"},"&:hover fieldset":{border:"none"},"&.Mui-focused fieldset":{border:"none"}}}}),(0,r.jsx)(o.Z,{})]})}},58094:function(e,n,t){"use strict";t.d(n,{Cx:function(){return v},HI:function(){return Z},Hv:function(){return S},It:function(){return j},OL:function(){return g},P7:function(){return q},RB:function(){return C},Rm:function(){return c},XO:function(){return d},Xl:function(){return K},Y7:function(){return x},Yn:function(){return T},bA:function(){return f},cy:function(){return w},ez:function(){return h},hV:function(){return y},ko:function(){return p},l2:function(){return b},pv:function(){return k},ur:function(){return F},yf:function(){return m}});var r=t(11713),i=t(29827),s=t(21770),l=t(9099),a=t(53675);let o={all:["admin"],users:()=>[...o.all,"users"],user:e=>[...o.users(),e],employees:()=>[...o.all,"employees"],activity:()=>[...o.all,"activity"],settings:()=>[...o.all,"settings"],loans:{all:()=>[...o.all,"loans","all"],allRepayments:()=>[...o.all,"loans","repayments","all"],userLoans:e=>[...o.all,"loans","user",e],userRepayments:e=>[...o.all,"loans","repayments","user",e],userWallet:e=>[...o.all,"loans","wallet",e],userEligibility:e=>[...o.all,"loans","eligibility",e]}},u={all:["providers"],list:()=>[...u.all,"list"]};function c(){let e=(0,l.t)(e=>e.token);return(0,r.a)({queryKey:o.users(),queryFn:()=>(0,a.zO)(e),enabled:!!e,refetchOnWindowFocus:!0,staleTime:6e4})}function d(e){let n=(0,l.t)(e=>e.token);return(0,r.a)({queryKey:[...o.users(),"detail",e],queryFn:()=>(0,a.eJ)(n,e),enabled:!!n&&!!e,staleTime:3e4})}function y(){let e=(0,l.t)(e=>e.token),n=(0,i.NL)();return(0,s.D)({mutationFn:n=>{let{id:t,payload:r}=n;return(0,a.vr)(e,t,r)},onSuccess:()=>{n.invalidateQueries({queryKey:o.users()}),f({action:"User edited"}),n.invalidateQueries({queryKey:o.activity()})}})}function m(e){let n=(0,l.t)(e=>e.token);return(0,r.a)({queryKey:[...o.activity(),null!=e?e:50],queryFn:()=>(0,a.Cy)(n,e),enabled:!!n,staleTime:3e4})}function f(e){let n=l.t.getState().token;n&&(0,a.BX)(n,e).catch(()=>{})}function x(){let e=(0,l.t)(e=>e.token),n=(0,i.NL)();return(0,s.D)({mutationFn:n=>(0,a.Er)(e,n),onSuccess:()=>{n.invalidateQueries({queryKey:o.users()}),f({action:"User deleted"}),n.invalidateQueries({queryKey:o.activity()})}})}function p(){let e=(0,l.t)(e=>e.token);return(0,r.a)({queryKey:u.list(),queryFn:()=>(0,a.xp)(e),enabled:!!e,refetchOnWindowFocus:!0,staleTime:6e4})}function h(){let e=(0,l.t)(e=>e.token),n=(0,i.NL)();return(0,s.D)({mutationFn:n=>(0,a.Qz)(e,n),onSuccess:()=>{n.invalidateQueries({queryKey:u.list()}),f({action:"Provider added"}),n.invalidateQueries({queryKey:o.activity()})}})}function g(){let e=(0,l.t)(e=>e.token);return(0,r.a)({queryKey:o.employees(),queryFn:()=>(0,a.vG)(e),enabled:!!e,refetchOnWindowFocus:!0,staleTime:6e4})}function v(){let e=(0,l.t)(e=>e.token),n=(0,i.NL)();return(0,s.D)({mutationFn:n=>(0,a.r8)(e,n),onSuccess:()=>{n.invalidateQueries({queryKey:o.employees()}),f({action:"Staff/employee created"}),n.invalidateQueries({queryKey:o.activity()})}})}function b(e){let n=(0,l.t)(e=>e.token);return(0,r.a)({queryKey:o.loans.userLoans(null!=e?e:""),queryFn:()=>(0,a.hJ)(n,e),enabled:!!n&&!!e,staleTime:3e4})}function j(e){let n=(0,l.t)(e=>e.token);return(0,r.a)({queryKey:o.loans.userRepayments(null!=e?e:""),queryFn:()=>(0,a.Rt)(n,e),enabled:!!n&&!!e,staleTime:3e4})}function Z(e){let n=(0,l.t)(e=>e.token);return(0,r.a)({queryKey:o.loans.userWallet(null!=e?e:""),queryFn:()=>(0,a.p0)(n,e),enabled:!!n&&!!e,staleTime:3e4})}function q(e){let n=(0,l.t)(e=>e.token);return(0,r.a)({queryKey:o.loans.userEligibility(null!=e?e:""),queryFn:()=>(0,a.Hd)(n,e),enabled:!!n&&!!e,staleTime:15e3})}function k(){let e=(0,l.t)(e=>e.token),n=(0,i.NL)();return(0,s.D)({mutationFn:n=>(0,a.G7)(e,n),onSuccess:(e,t)=>{n.invalidateQueries({queryKey:o.loans.userLoans(t.userId)}),n.invalidateQueries({queryKey:o.loans.userWallet(t.userId)}),n.invalidateQueries({queryKey:o.loans.userRepayments(t.userId)}),n.invalidateQueries({queryKey:o.loans.userEligibility(t.userId)}),n.invalidateQueries({queryKey:o.loans.all()}),n.invalidateQueries({queryKey:o.loans.allRepayments()})}})}function K(){let e=(0,l.t)(e=>e.token);return(0,r.a)({queryKey:o.loans.all(),queryFn:()=>(0,a.cA)(e),enabled:!!e,refetchOnWindowFocus:!0,staleTime:3e4})}function C(){let e=(0,l.t)(e=>e.token);return(0,r.a)({queryKey:o.loans.allRepayments(),queryFn:()=>(0,a.Cb)(e),enabled:!!e,refetchOnWindowFocus:!0,staleTime:3e4})}function w(){let e=(0,l.t)(e=>e.token),n=(0,i.NL)();return(0,s.D)({mutationFn:n=>(0,a.xl)(e,n),onSuccess:()=>{n.invalidateQueries({queryKey:o.loans.all()}),f({action:"Loan approved"}),n.invalidateQueries({queryKey:o.activity()})}})}function F(){let e=(0,l.t)(e=>e.token),n=(0,i.NL)();return(0,s.D)({mutationFn:n=>(0,a.ey)(e,n),onSuccess:()=>{n.invalidateQueries({queryKey:o.loans.all()}),f({action:"Loan rejected"}),n.invalidateQueries({queryKey:o.activity()})}})}function S(){let e=(0,l.t)(e=>e.token);return(0,r.a)({queryKey:o.settings(),queryFn:()=>(0,a.hO)(e),enabled:!!e,staleTime:6e4})}function T(){let e=(0,l.t)(e=>e.token),n=(0,i.NL)();return(0,s.D)({mutationFn:n=>{let{key:t,value:r}=n;return(0,a.WD)(e,t,r)},onSuccess:()=>{n.invalidateQueries({queryKey:o.settings()})}})}},39107:function(e,n,t){"use strict";var r=t(9973);n.Z=void 0;var i=r(t(59815)),s=t(57437);n.Z=(0,i.default)((0,s.jsx)("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8m.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"}),"AccessTimeOutlined")}},function(e){e.O(0,[515,330,262,666,140,404,713,857,887,675,971,117,744],function(){return e(e.s=67502)}),_N_E=e.O()}]);