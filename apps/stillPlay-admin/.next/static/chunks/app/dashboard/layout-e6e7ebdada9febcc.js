(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[663],{6293:function(e,t,n){Promise.resolve().then(n.bind(n,3301))},3301:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return U}});var o=n(7437),s=n(1899),i=n(8984),a=n(5002),l=n(9832),r=n(2253),d=n(9465),c=n(2265),u=n(9376),p=n(7375),h=n(9714),x=n(26),f=n(4322),m=n(7315),g=n(642),v=n(7116),b=n(5389),j=n(8350),y=n(4013),Z=n(8444),C=n(4236),S=n(7648),w=n(3675),P=n(8094),k=n(9099),L=n(8219);let R=[{label:"Users",href:"/dashboard",icon:(0,o.jsx)(f.Z,{})},{label:"Providers",href:"/dashboard/providers",icon:(0,o.jsx)(p.Z,{})},{label:"Staff",href:"/dashboard/staff",icon:(0,o.jsx)(h.Z,{})},{label:"Loan Request",href:"/dashboard/loan-request"},{label:"Loan Repayment",href:"/dashboard/loan-repayment"},{label:"Support",href:"/dashboard/support",icon:(0,o.jsx)(g.Z,{})},{label:"Settings",href:"/dashboard/settings",icon:(0,o.jsx)(m.Z,{})}];function N(e){var t,n,l,r,d,p,h,f,m,g,N;let{onNavigate:E}=e,U=(0,u.usePathname)(),A=(0,u.useRouter)(),V=(0,c.useRef)(null),[_,D]=(0,c.useState)(!1),[I,O]=(0,c.useState)(!1),[T,q]=(0,c.useState)(!1),[z,H]=(0,c.useState)(""),M=(0,k.t)(e=>e.reset),W=(0,k.t)(e=>e.token),X=(0,k.t)(e=>e.fullName),Y=(0,k.t)(e=>e.user),B=(0,k.t)(e=>e.setUser),F=(0,L.LM)(e=>e.profile),G=(0,L.LM)(e=>e.setProfile),J=(0,L.LM)(e=>e.reset),K=(0,P.hV)(),Q=(null==F?void 0:F.firstName)&&(null==F?void 0:F.lastName)?"".concat(F.firstName," ").concat(F.lastName).trim():null!==(l=null!==(n=null!==(t=null==F?void 0:F.firstName)&&void 0!==t?t:null==F?void 0:F.email)&&void 0!==n?n:X)&&void 0!==l?l:"Admin",$=(null!==(r=null==F?void 0:F.role)&&void 0!==r?r:null==Y?void 0:Y.role)?String(null!==(d=null==F?void 0:F.role)&&void 0!==d?d:null==Y?void 0:Y.role).trim():"Admin",ee=null!==(h=null!==(p=null==F?void 0:F.email)&&void 0!==p?p:null==Y?void 0:Y.email)&&void 0!==h?h:"",et=null!==(m=null!==(f=null==F?void 0:F.picture)&&void 0!==f?f:null==Y?void 0:Y.picture)&&void 0!==m?m:null,en=null!==(g=null==F?void 0:F.id)&&void 0!==g?g:null==Y?void 0:Y.id,eo=async e=>{var t;let n=null===(t=e.target.files)||void 0===t?void 0:t[0];if(n){if(!en||!W){H("Cannot update photo: session or user id missing. Try logging in again."),q(!0),e.target.value="";return}D(!0);try{let e=await (0,w.Ix)(n,{folder:"stillplay/avatars",token:W});K.mutate({id:en,payload:{picture:e.secureUrl}},{onSuccess:()=>{let t=e.secureUrl;F&&G({...F,picture:t}),Y&&B({...Y,picture:t}),O(!0)},onSettled:()=>D(!1)})}catch(e){console.error(e),D(!1),H(e instanceof Error?e.message:"Upload failed"),q(!0)}finally{e.target.value=""}}};return(0,o.jsxs)(i.Z,{component:C.E.aside,initial:{opacity:0,x:-16},animate:{opacity:1,x:0},transition:{duration:.45,ease:"easeOut"},sx:{padding:{xs:2,md:3},height:"100%",minHeight:"100vh",justifyContent:"space-between"},children:[(0,o.jsxs)(i.Z,{spacing:3,children:[(0,o.jsx)(s.Z,{component:"img",src:"/assets/svg/STILL PLAYLOGOBL.svg",alt:"Still Play",sx:{width:140,height:"auto",marginX:"auto"}}),(0,o.jsxs)(s.Z,{sx:{textAlign:"center"},children:[(0,o.jsx)("input",{id:"sidebar-avatar-upload",ref:V,type:"file",accept:"image/*",style:{display:"none"},"aria-label":"Upload profile photo",disabled:_||K.isPending,onChange:eo}),(0,o.jsxs)(s.Z,{component:"label",htmlFor:"sidebar-avatar-upload",sx:{position:"relative",display:"inline-block",margin:"0 auto 8px",cursor:en?"pointer":"default"},children:[(0,o.jsx)(v.Z,{src:null!=et?et:void 0,sx:{width:76,height:76,border:"2px solid #0b7b4c",opacity:_||K.isPending?.7:1},children:(null!==(N=null==Q?void 0:Q[0])&&void 0!==N?N:"?").toUpperCase()}),(_||K.isPending)&&(0,o.jsx)(s.Z,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",bgcolor:"rgba(0,0,0,0.4)",pointerEvents:"none"},children:(0,o.jsx)(b.Z,{size:32,sx:{color:"white"}})})]}),(0,o.jsx)(a.Z,{variant:"subtitle2",children:Q.toUpperCase()}),ee?(0,o.jsx)(a.Z,{variant:"caption",color:"text.secondary",display:"block",children:ee}):null,(0,o.jsx)(a.Z,{variant:"caption",color:"primary",children:$.toUpperCase()})]}),(0,o.jsx)(j.Z,{sx:{opacity:.5}}),(0,o.jsx)(i.Z,{spacing:1,children:R.map(e=>{let t=U===e.href;return(0,o.jsx)(S.default,{href:e.href,style:{textDecoration:"none"},children:(0,o.jsx)(y.Z,{fullWidth:!0,variant:"text",startIcon:e.icon,onClick:E,sx:{justifyContent:"flex-start",color:t?"#f59e0b":"text.primary",backgroundColor:t?"#f3f3f3":"transparent",borderRadius:999,paddingY:1,paddingX:2},children:e.label})},e.href)})}),(0,o.jsx)(S.default,{href:"/dashboard/staff",style:{textDecoration:"none"},children:(0,o.jsx)(y.Z,{variant:"contained",size:"small",fullWidth:!0,onClick:E,children:"Create Admin Account"})})]}),(0,o.jsxs)(i.Z,{spacing:2,children:[(0,o.jsx)(j.Z,{sx:{opacity:.5}}),(0,o.jsx)(y.Z,{variant:"text",color:"error",startIcon:(0,o.jsx)(x.Z,{}),onClick:()=>{M(),J(),A.push("/")},sx:{justifyContent:"flex-start"},children:"Log out"})]}),(0,o.jsx)(Z.Z,{open:I,autoHideDuration:4e3,onClose:()=>O(!1),message:"Profile photo updated successfully",anchorOrigin:{vertical:"bottom",horizontal:"center"},ContentProps:{sx:{bgcolor:"success.main",color:"success.contrastText"}}}),(0,o.jsx)(Z.Z,{open:T,autoHideDuration:6e3,onClose:()=>q(!1),message:z,anchorOrigin:{vertical:"bottom",horizontal:"center"},ContentProps:{sx:{bgcolor:"error.main",color:"error.contrastText"}}})]})}let E={"/dashboard":"Viewed Dashboard","/dashboard/providers":"Viewed Providers","/dashboard/staff":"Viewed Staff","/dashboard/loan-request":"Viewed Loan Request","/dashboard/loan-repayment":"Viewed Loan Repayment","/dashboard/support":"Viewed Support","/dashboard/settings":"Viewed Settings"};function U(e){let{children:t}=e,n=(0,u.useRouter)(),p=(0,u.usePathname)(),h=(0,k.t)(e=>e.status),x=(0,k.t)(e=>e.token),f=(0,k.t)(e=>e.setLastAction),m=(0,k.t)(e=>e.lastLoginIp),g=(0,k.t)(e=>e._hasRehydrated),[v,b]=(0,c.useState)(!1);return(0,c.useEffect)(()=>{let e=E[null!=p?p:""];e&&(f(e),(0,P.bA)({action:e,ip:null!=m?m:void 0}))},[p,f,m]),(0,c.useEffect)(()=>{g&&("authenticated"!==h||!x)&&n.replace("/")},[n,h,x,g]),(0,c.useEffect)(()=>{let e=setTimeout(()=>{k.t.getState()._hasRehydrated||k.t.getState().setRehydrated()},150);return()=>clearTimeout(e)},[]),(0,o.jsxs)(s.Z,{sx:{minHeight:"100vh",backgroundColor:"#fff",display:{xs:"flex",md:"grid"},flexDirection:{xs:"column",md:"unset"},gridTemplateColumns:{md:"260px 1fr"}},children:[(0,o.jsx)(s.Z,{sx:{display:{xs:"none",md:"block"}},children:(0,o.jsx)(N,{})}),(0,o.jsxs)(i.Z,{sx:{flex:1},children:[(0,o.jsxs)(i.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{display:{xs:"flex",md:"none"},paddingX:2,paddingY:1.5,borderBottom:"1px solid #edf2ef"},children:[(0,o.jsx)(a.Z,{variant:"h6",fontWeight:700,children:"Dashboard"}),(0,o.jsx)(l.Z,{onClick:()=>b(!0),children:(0,o.jsx)(d.Z,{})})]}),(0,o.jsx)(s.Z,{sx:{padding:{xs:2,md:3},flex:1},children:t})]}),(0,o.jsx)(r.ZP,{open:v,onClose:()=>b(!1),sx:{display:{xs:"block",md:"none"}},PaperProps:{sx:{width:260}},children:(0,o.jsx)(N,{onNavigate:()=>b(!1)})})]})}}},function(e){e.O(0,[165,43,498,262,49,135,713,448,253,812,94,971,117,744],function(){return e(e.s=6293)}),_N_E=e.O()}]);