(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[455],{69076:function(e,n,t){Promise.resolve().then(t.bind(t,2691))},2691:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return F}});var i=t(57437),r=t(2265),s=t(54446),a=t(13241),l=t(98681),o=t(2870),u=t(96207),c=t(8984),d=t(1899),m=t(5002),y=t(74731),x=t(97404),f=t(23996),h=t(82279),v=t(94013),p=t(99962),g=t(28450),j=t(22095),Z=t(70208),S=t(32281),b=t(54301),q=t(61201),W=t(59469),K=t(58094),k=t(9099);function w(){let{data:e,isLoading:n}=(0,K.Hv)(),t=(0,K.Yn)(),[s,a]=(0,r.useState)(""),[l,p]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{(null==e?void 0:e.loan_max_amount)!==void 0&&a(e.loan_max_amount)},[e]),(0,i.jsx)(u.Z,{variant:"outlined",sx:{p:{xs:2,md:3},borderRadius:3,maxWidth:480,width:"100%"},children:(0,i.jsxs)(c.Z,{spacing:3,children:[(0,i.jsxs)(c.Z,{direction:"row",alignItems:"center",spacing:2,children:[(0,i.jsx)(o.Z,{sx:{color:"primary.main",fontSize:28}}),(0,i.jsxs)(d.Z,{children:[(0,i.jsx)(m.Z,{variant:"subtitle1",fontWeight:700,children:"Maximum loan amount"}),(0,i.jsx)(m.Z,{variant:"body2",color:"text.secondary",children:"Sets the highest amount a user can request in a single loan."})]})]}),n?(0,i.jsx)(y.Z,{height:56}):(0,i.jsx)(x.Z,{label:"Max loan amount (₦)",value:s,onChange:e=>{a(e.target.value.replace(/[^0-9]/g,"")),p(!1)},type:"text",inputProps:{inputMode:"numeric"},InputProps:{startAdornment:(0,i.jsx)(f.Z,{position:"start",children:"₦"})},helperText:"Default is ₦5,000. Changes apply immediately for new loan requests.",fullWidth:!0}),t.isError&&(0,i.jsx)(h.Z,{severity:"error",children:t.error.message}),l&&(0,i.jsx)(h.Z,{severity:"success",children:"Maximum loan amount saved successfully."}),(0,i.jsx)(v.Z,{variant:"contained",onClick:()=>{let e=Number(s);!s||isNaN(e)||e<=0||t.mutate({key:"loan_max_amount",value:String(e)},{onSuccess:()=>{p(!0),setTimeout(()=>p(!1),3e3)}})},disabled:t.isPending||!s,sx:{alignSelf:"flex-start",textTransform:"none",fontWeight:600},children:t.isPending?"Saving...":"Save"})]})})}function F(){var e;let[n,t]=(0,r.useState)(0),o=(0,k.t)(e=>e.lastLoginAt),y=(0,k.t)(e=>e.lastLoginIp),x=(0,k.t)(e=>e.lastAction),f=(0,k.t)(e=>e.setLastLoginIp),{data:h,isLoading:v}=(0,K.yf)(50),F=null!==(e=null==h?void 0:h.activities)&&void 0!==e?e:[],L=(0,r.useCallback)(()=>{fetch("https://api.ipify.org?format=json").then(e=>e.json()).then(e=>{(null==e?void 0:e.ip)&&f(e.ip)}).catch(()=>{})},[f]);return(0,r.useEffect)(()=>{y||L()},[y,L]),(0,i.jsxs)(d.Z,{sx:{width:"100%",maxWidth:"100%",overflowX:"hidden"},children:[(0,i.jsx)(m.Z,{variant:"h5",fontWeight:700,sx:{mb:3,fontSize:{xs:"1.25rem",md:"1.5rem"}},children:"Settings"}),(0,i.jsxs)(p.Z,{value:n,onChange:(e,n)=>t(n),sx:{borderBottom:1,borderColor:"divider",mb:3,"& .MuiTab-root":{textTransform:"none",fontWeight:600},"& .MuiTabs-flexContainer":{flexWrap:"wrap"}},children:[(0,i.jsx)(g.Z,{label:"Activity"}),(0,i.jsx)(g.Z,{label:"Loan Settings"})]}),0===n&&(0,i.jsxs)(d.Z,{children:[(0,i.jsx)(u.Z,{variant:"outlined",sx:{p:{xs:2,md:3},borderRadius:3,maxWidth:560,width:"100%",mb:4},children:(0,i.jsxs)(c.Z,{spacing:3,children:[(0,i.jsxs)(c.Z,{direction:"row",alignItems:"center",spacing:2,flexWrap:"wrap",children:[(0,i.jsx)(s.Z,{sx:{color:"primary.main",fontSize:{xs:24,md:28}}}),(0,i.jsxs)(d.Z,{minWidth:0,children:[(0,i.jsx)(m.Z,{variant:"caption",color:"text.secondary",children:"Last logged in"}),(0,i.jsx)(m.Z,{variant:"body1",fontWeight:600,sx:{fontSize:{xs:"0.875rem",md:"1rem"}},children:null==o?"—":new Date(o).toLocaleString(void 0,{dateStyle:"medium",timeStyle:"short"})})]})]}),(0,i.jsxs)(c.Z,{direction:"row",alignItems:"center",spacing:2,flexWrap:"wrap",children:[(0,i.jsx)(a.Z,{sx:{color:"primary.main",fontSize:{xs:24,md:28}}}),(0,i.jsxs)(d.Z,{minWidth:0,children:[(0,i.jsx)(m.Z,{variant:"caption",color:"text.secondary",children:"IP address"}),(0,i.jsx)(m.Z,{variant:"body1",fontWeight:600,sx:{fontSize:{xs:"0.875rem",md:"1rem"}},children:y||"—"})]})]}),(0,i.jsxs)(c.Z,{direction:"row",alignItems:"center",spacing:2,flexWrap:"wrap",children:[(0,i.jsx)(l.Z,{sx:{color:"primary.main",fontSize:{xs:24,md:28}}}),(0,i.jsxs)(d.Z,{minWidth:0,children:[(0,i.jsx)(m.Z,{variant:"caption",color:"text.secondary",children:"Last action"}),(0,i.jsx)(m.Z,{variant:"body1",fontWeight:600,sx:{fontSize:{xs:"0.875rem",md:"1rem"}},children:x||"—"})]})]})]})}),(0,i.jsx)(m.Z,{variant:"subtitle1",fontWeight:600,sx:{mb:2},children:"Activity history"}),(0,i.jsx)(j.Z,{component:u.Z,variant:"outlined",sx:{borderRadius:2,overflowX:"auto",maxWidth:"100%"},children:(0,i.jsxs)(Z.Z,{size:"small",sx:{minWidth:320},children:[(0,i.jsx)(S.Z,{children:(0,i.jsxs)(b.Z,{sx:{bgcolor:"grey.50"},children:[(0,i.jsx)(q.Z,{sx:{fontWeight:700,fontSize:{xs:"0.75rem",md:"0.875rem"}},children:"Activity ID"}),(0,i.jsx)(q.Z,{sx:{fontWeight:700,fontSize:{xs:"0.75rem",md:"0.875rem"}},children:"Action"}),(0,i.jsx)(q.Z,{sx:{fontWeight:700,fontSize:{xs:"0.75rem",md:"0.875rem"}},children:"IP"}),(0,i.jsx)(q.Z,{sx:{fontWeight:700,fontSize:{xs:"0.75rem",md:"0.875rem"}},children:"Time"})]})}),(0,i.jsx)(W.Z,{children:v?(0,i.jsx)(b.Z,{children:(0,i.jsx)(q.Z,{colSpan:4,align:"center",children:"Loading..."})}):0===F.length?(0,i.jsx)(b.Z,{children:(0,i.jsx)(q.Z,{colSpan:4,align:"center",sx:{color:"text.secondary"},children:"No activity recorded yet."})}):F.map(e=>{var n;return(0,i.jsxs)(b.Z,{children:[(0,i.jsx)(q.Z,{sx:{fontFamily:"monospace",fontSize:{xs:"0.7rem",md:"0.8rem"},maxWidth:{xs:80,md:"none"},overflow:"hidden",textOverflow:"ellipsis"},title:e.id,children:e.id}),(0,i.jsx)(q.Z,{sx:{fontSize:{xs:"0.75rem",md:"0.875rem"}},children:e.action}),(0,i.jsx)(q.Z,{sx:{fontSize:{xs:"0.75rem",md:"0.875rem"}},children:null!==(n=e.ip)&&void 0!==n?n:"—"}),(0,i.jsx)(q.Z,{sx:{fontSize:{xs:"0.75rem",md:"0.875rem"},whiteSpace:"nowrap"},children:new Date(e.createdAt).toLocaleString(void 0,{dateStyle:"short",timeStyle:"short"})})]},e.id)})})]})})]}),1===n&&(0,i.jsx)(w,{})]})}},58094:function(e,n,t){"use strict";t.d(n,{Cx:function(){return g},HI:function(){return S},Hv:function(){return F},It:function(){return Z},OL:function(){return p},P7:function(){return b},RB:function(){return K},Rm:function(){return c},XO:function(){return d},Xl:function(){return W},Y7:function(){return f},Yn:function(){return L},bA:function(){return x},cy:function(){return k},ez:function(){return v},hV:function(){return m},ko:function(){return h},l2:function(){return j},pv:function(){return q},ur:function(){return w},yf:function(){return y}});var i=t(11713),r=t(29827),s=t(21770),a=t(9099),l=t(53675);let o={all:["admin"],users:()=>[...o.all,"users"],user:e=>[...o.users(),e],employees:()=>[...o.all,"employees"],activity:()=>[...o.all,"activity"],settings:()=>[...o.all,"settings"],loans:{all:()=>[...o.all,"loans","all"],allRepayments:()=>[...o.all,"loans","repayments","all"],userLoans:e=>[...o.all,"loans","user",e],userRepayments:e=>[...o.all,"loans","repayments","user",e],userWallet:e=>[...o.all,"loans","wallet",e],userEligibility:e=>[...o.all,"loans","eligibility",e]}},u={all:["providers"],list:()=>[...u.all,"list"]};function c(){let e=(0,a.t)(e=>e.token);return(0,i.a)({queryKey:o.users(),queryFn:()=>(0,l.zO)(e),enabled:!!e,refetchOnWindowFocus:!0,staleTime:6e4})}function d(e){let n=(0,a.t)(e=>e.token);return(0,i.a)({queryKey:[...o.users(),"detail",e],queryFn:()=>(0,l.eJ)(n,e),enabled:!!n&&!!e,staleTime:3e4})}function m(){let e=(0,a.t)(e=>e.token),n=(0,r.NL)();return(0,s.D)({mutationFn:n=>{let{id:t,payload:i}=n;return(0,l.vr)(e,t,i)},onSuccess:()=>{n.invalidateQueries({queryKey:o.users()}),x({action:"User edited"}),n.invalidateQueries({queryKey:o.activity()})}})}function y(e){let n=(0,a.t)(e=>e.token);return(0,i.a)({queryKey:[...o.activity(),null!=e?e:50],queryFn:()=>(0,l.Cy)(n,e),enabled:!!n,staleTime:3e4})}function x(e){let n=a.t.getState().token;n&&(0,l.BX)(n,e).catch(()=>{})}function f(){let e=(0,a.t)(e=>e.token),n=(0,r.NL)();return(0,s.D)({mutationFn:n=>(0,l.Er)(e,n),onSuccess:()=>{n.invalidateQueries({queryKey:o.users()}),x({action:"User deleted"}),n.invalidateQueries({queryKey:o.activity()})}})}function h(){let e=(0,a.t)(e=>e.token);return(0,i.a)({queryKey:u.list(),queryFn:()=>(0,l.xp)(e),enabled:!!e,refetchOnWindowFocus:!0,staleTime:6e4})}function v(){let e=(0,a.t)(e=>e.token),n=(0,r.NL)();return(0,s.D)({mutationFn:n=>(0,l.Qz)(e,n),onSuccess:()=>{n.invalidateQueries({queryKey:u.list()}),x({action:"Provider added"}),n.invalidateQueries({queryKey:o.activity()})}})}function p(){let e=(0,a.t)(e=>e.token);return(0,i.a)({queryKey:o.employees(),queryFn:()=>(0,l.vG)(e),enabled:!!e,refetchOnWindowFocus:!0,staleTime:6e4})}function g(){let e=(0,a.t)(e=>e.token),n=(0,r.NL)();return(0,s.D)({mutationFn:n=>(0,l.r8)(e,n),onSuccess:()=>{n.invalidateQueries({queryKey:o.employees()}),x({action:"Staff/employee created"}),n.invalidateQueries({queryKey:o.activity()})}})}function j(e){let n=(0,a.t)(e=>e.token);return(0,i.a)({queryKey:o.loans.userLoans(null!=e?e:""),queryFn:()=>(0,l.hJ)(n,e),enabled:!!n&&!!e,staleTime:3e4})}function Z(e){let n=(0,a.t)(e=>e.token);return(0,i.a)({queryKey:o.loans.userRepayments(null!=e?e:""),queryFn:()=>(0,l.Rt)(n,e),enabled:!!n&&!!e,staleTime:3e4})}function S(e){let n=(0,a.t)(e=>e.token);return(0,i.a)({queryKey:o.loans.userWallet(null!=e?e:""),queryFn:()=>(0,l.p0)(n,e),enabled:!!n&&!!e,staleTime:3e4})}function b(e){let n=(0,a.t)(e=>e.token);return(0,i.a)({queryKey:o.loans.userEligibility(null!=e?e:""),queryFn:()=>(0,l.Hd)(n,e),enabled:!!n&&!!e,staleTime:15e3})}function q(){let e=(0,a.t)(e=>e.token),n=(0,r.NL)();return(0,s.D)({mutationFn:n=>(0,l.G7)(e,n),onSuccess:(e,t)=>{n.invalidateQueries({queryKey:o.loans.userLoans(t.userId)}),n.invalidateQueries({queryKey:o.loans.userWallet(t.userId)}),n.invalidateQueries({queryKey:o.loans.userRepayments(t.userId)}),n.invalidateQueries({queryKey:o.loans.userEligibility(t.userId)}),n.invalidateQueries({queryKey:o.loans.all()}),n.invalidateQueries({queryKey:o.loans.allRepayments()})}})}function W(){let e=(0,a.t)(e=>e.token);return(0,i.a)({queryKey:o.loans.all(),queryFn:()=>(0,l.cA)(e),enabled:!!e,refetchOnWindowFocus:!0,staleTime:3e4})}function K(){let e=(0,a.t)(e=>e.token);return(0,i.a)({queryKey:o.loans.allRepayments(),queryFn:()=>(0,l.Cb)(e),enabled:!!e,refetchOnWindowFocus:!0,staleTime:3e4})}function k(){let e=(0,a.t)(e=>e.token),n=(0,r.NL)();return(0,s.D)({mutationFn:n=>(0,l.xl)(e,n),onSuccess:()=>{n.invalidateQueries({queryKey:o.loans.all()}),x({action:"Loan approved"}),n.invalidateQueries({queryKey:o.activity()})}})}function w(){let e=(0,a.t)(e=>e.token),n=(0,r.NL)();return(0,s.D)({mutationFn:n=>(0,l.ey)(e,n),onSuccess:()=>{n.invalidateQueries({queryKey:o.loans.all()}),x({action:"Loan rejected"}),n.invalidateQueries({queryKey:o.activity()})}})}function F(){let e=(0,a.t)(e=>e.token);return(0,i.a)({queryKey:o.settings(),queryFn:()=>(0,l.hO)(e),enabled:!!e,staleTime:6e4})}function L(){let e=(0,a.t)(e=>e.token),n=(0,r.NL)();return(0,s.D)({mutationFn:n=>{let{key:t,value:i}=n;return(0,l.WD)(e,t,i)},onSuccess:()=>{n.invalidateQueries({queryKey:o.settings()})}})}}},function(e){e.O(0,[515,330,262,666,140,404,713,872,703,675,971,117,744],function(){return e(e.s=69076)}),_N_E=e.O()}]);