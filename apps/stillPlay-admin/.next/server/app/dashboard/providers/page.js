(()=>{var e={};e.id=818,e.ids=[818],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29740:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>s.a,__next_app__:()=>x,originalPathname:()=>p,pages:()=>c,routeModule:()=>u,tree:()=>d}),t(51034),t(86400),t(84752),t(35866);var a=t(23191),i=t(88716),n=t(37922),s=t.n(n),o=t(95231),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);t.d(r,l);let d=["",{children:["dashboard",{children:["providers",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,51034)),"/Users/adamabdullahi/Documents/Js_portfolio/stillPlay/microservices/my-workspace/apps/stillPlay-admin/app/dashboard/providers/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,86400)),"/Users/adamabdullahi/Documents/Js_portfolio/stillPlay/microservices/my-workspace/apps/stillPlay-admin/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,84752)),"/Users/adamabdullahi/Documents/Js_portfolio/stillPlay/microservices/my-workspace/apps/stillPlay-admin/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/adamabdullahi/Documents/Js_portfolio/stillPlay/microservices/my-workspace/apps/stillPlay-admin/app/dashboard/providers/page.tsx"],p="/dashboard/providers/page",x={require:t,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/dashboard/providers/page",pathname:"/dashboard/providers",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},67755:(e,r,t)=>{Promise.resolve().then(t.bind(t,88432))},88432:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>N});var a=t(10326),i=t(84873),n=t(99069),s=t(71728),o=t(88464),l=t(30274),d=t(14326),c=t(48260),p=t(42265),x=t(98139),u=t(69995),m=t(98117),h=t(28591),g=t(90541),f=t(99207),v=t(57329),b=t(59351),j=t(10163),Z=t(17577),y=t(2241),P=t(72894),C=t(92972),k=t(5031);function W(e){return null==e?"—":new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN",minimumFractionDigits:0,maximumFractionDigits:2}).format(e)}function w({p:e}){let r=e.percentageToAdd??0,t=e.providerCutPercentage??0,i=(0,k.WN)(e),n=(0,k.I2)(e);return(0,a.jsxs)(s.Z,{sx:{paddingY:2,paddingX:{xs:2,md:3},borderBottom:"1px solid #f3f3f3",display:{xs:"flex",md:"grid"},flexDirection:{xs:"column",md:"unset"},gridTemplateColumns:{md:"1.2fr 0.8fr 1fr 0.9fr 1fr 1.1fr 1.1fr 0.8fr"},alignItems:"center",gap:{xs:.5,md:1},backgroundColor:"#ffffff",borderRadius:1,"&:hover":{backgroundColor:"#fafafa"}},children:[(0,a.jsxs)(o.Z,{spacing:.2,children:[a.jsx(l.Z,{variant:"body2",fontWeight:600,children:e.name}),a.jsx(l.Z,{variant:"caption",color:"text.secondary",children:e.providerNumber??"—"})]}),a.jsx(l.Z,{variant:"body2",color:"text.secondary",sx:{fontSize:12},children:e.email??"—"}),(0,a.jsxs)(o.Z,{spacing:.2,children:[a.jsx(l.Z,{variant:"body2",fontWeight:500,children:e.bankName??"—"}),a.jsx(l.Z,{variant:"caption",color:"text.secondary",sx:{fontFamily:"monospace"},children:e.accountNumber??"—"})]}),a.jsx(l.Z,{variant:"body2",children:W(e.agreedAmount)}),(0,a.jsxs)(o.Z,{spacing:.2,children:[a.jsx(l.Z,{variant:"body2",fontWeight:500,children:r>0?`${r}% total`:"—"}),(0,a.jsxs)(o.Z,{direction:"row",spacing:.5,alignItems:"center",children:[(0,a.jsxs)(l.Z,{variant:"caption",sx:{color:"#0b7b4c",fontWeight:600},children:[t,"% provider"]}),a.jsx(l.Z,{variant:"caption",color:"text.secondary",children:"/"}),(0,a.jsxs)(l.Z,{variant:"caption",sx:{color:"#b45309",fontWeight:600},children:[Math.max(0,r-t),"% company"]})]})]}),a.jsx(d.Z,{title:"Amount returned to provider (principal + their cut)",placement:"top",children:(0,a.jsxs)(o.Z,{spacing:.2,children:[a.jsx(l.Z,{variant:"body2",fontWeight:500,sx:{color:"#0b7b4c"},children:W(i)}),a.jsx(l.Z,{variant:"caption",color:"text.secondary",children:"provider return"})]})}),a.jsx(d.Z,{title:"Company's earnings from this provider's loans",placement:"top",children:(0,a.jsxs)(o.Z,{spacing:.2,children:[a.jsx(l.Z,{variant:"body2",fontWeight:500,sx:{color:"#b45309"},children:W(n)}),a.jsx(l.Z,{variant:"caption",color:"text.secondary",children:"company cut"})]})}),a.jsx(l.Z,{variant:"body2",color:"text.secondary",sx:{fontSize:12},children:function(e){if(!e)return"—";try{return new Date(e).toLocaleDateString()}catch{return"—"}}(e.agreedAt)})]})}function N(){let[e,r]=(0,Z.useState)(""),[t,d]=(0,Z.useState)(!1),[k,N]=(0,Z.useState)(""),[A,S]=(0,Z.useState)(""),[_,T]=(0,Z.useState)(""),[I,R]=(0,Z.useState)(""),[D,F]=(0,Z.useState)(""),[E,L]=(0,Z.useState)(""),[M,q]=(0,Z.useState)(""),[G,z]=(0,Z.useState)(""),[B,J]=(0,Z.useState)(""),{data:U=[],isLoading:O,isError:X,error:V,refetch:Y,isFetching:H}=(0,C.ko)(),$=(0,C.ez)(),K=(0,Z.useMemo)(()=>{if(!e.trim())return U;let r=e.trim().toLowerCase();return U.filter(e=>e.name.toLowerCase().includes(r)||(e.email??"").toLowerCase().includes(r)||(e.providerNumber??"").toLowerCase().includes(r)||(e.bankName??"").toLowerCase().includes(r)||(e.accountNumber??"").includes(r))},[U,e]),Q=()=>{N(""),S(""),T(""),R(""),F(""),L(""),q(""),z(""),J(""),d(!1)},ee=parseFloat(E)||0,er=parseFloat(M)||0,et=Math.max(0,ee-Math.min(er,ee)),ea=E&&M&&er>ee?"Provider % cannot exceed total %":null;return(0,a.jsxs)(s.Z,{component:y.E.div,initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{duration:.45,ease:"easeOut"},children:[a.jsx(P.Z,{search:e,onSearchChange:r}),a.jsx(s.Z,{sx:{background:"#ffffff",borderRadius:{xs:0,md:2},padding:{xs:2,md:3.5},paddingBottom:{xs:3,md:4},marginTop:{xs:2,md:3},marginX:{xs:-2,md:0},minHeight:"calc(100vh - 220px)",display:"flex",flexDirection:"column"},children:a.jsx(o.Z,{spacing:2,children:(0,a.jsxs)(s.Z,{sx:{borderRadius:3,padding:2,backgroundColor:"#f3f3f3",display:"flex",flexDirection:"column"},children:[(0,a.jsxs)(o.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:1,sx:{marginBottom:2,paddingTop:2,paddingLeft:2},children:[a.jsx(l.Z,{variant:"h6",sx:{fontWeight:700},children:"PROVIDERS"}),(0,a.jsxs)(o.Z,{direction:"row",spacing:1,children:[a.jsx(c.Z,{size:"small",onClick:()=>Y(),disabled:H,"aria-label":"Refresh list",children:a.jsx(n.Z,{})}),a.jsx(p.Z,{variant:"contained",size:"small",startIcon:a.jsx(i.Z,{}),onClick:()=>d(!0),sx:{backgroundColor:"#0b7b4c"},children:"Register provider"})]})]}),(0,a.jsxs)(s.Z,{sx:{fontSize:12,color:"text.secondary",marginBottom:2,backgroundColor:"#fff",borderRadius:999,paddingY:1.2,paddingX:3,display:{xs:"none",md:"grid"},gridTemplateColumns:{md:"1.2fr 0.8fr 1fr 0.9fr 1.1fr 1.1fr 1.1fr 0.8fr"},alignItems:"center",gap:1},children:[a.jsx(s.Z,{children:"Name / #"}),a.jsx(s.Z,{children:"Email"}),a.jsx(s.Z,{children:"Bank / Account"}),a.jsx(s.Z,{children:"Agreed amount"}),a.jsx(s.Z,{children:"% split"}),a.jsx(s.Z,{children:"Provider return"}),a.jsx(s.Z,{children:"Company cut"}),a.jsx(s.Z,{children:"Date"})]}),a.jsx(s.Z,{sx:{marginTop:1},children:O?(0,a.jsxs)(o.Z,{alignItems:"center",py:4,children:[a.jsx(x.Z,{sx:{color:"#0b7b4c"}}),a.jsx(l.Z,{variant:"body2",color:"text.secondary",sx:{mt:2},children:"Loading providers..."})]}):X?(0,a.jsxs)(o.Z,{alignItems:"center",py:4,spacing:2,children:[a.jsx(l.Z,{color:"error",children:V.message}),a.jsx(p.Z,{variant:"outlined",onClick:()=>Y(),size:"small",children:"Retry"})]}):0===K.length?a.jsx(l.Z,{color:"text.secondary",sx:{py:4,textAlign:"center"},children:"No providers yet. Register one to get started."}):a.jsx(o.Z,{spacing:0,children:K.map(e=>a.jsx(w,{p:e},e.id))})})]})})}),(0,a.jsxs)(u.Z,{open:t,onClose:Q,PaperProps:{sx:{borderRadius:2}},maxWidth:"sm",fullWidth:!0,children:[a.jsx(m.Z,{fontWeight:700,children:"Register provider"}),a.jsx(h.Z,{children:(0,a.jsxs)(o.Z,{spacing:2.5,sx:{pt:1},children:[a.jsx(g.Z,{label:"Provider / company name",required:!0,fullWidth:!0,value:k,onChange:e=>N(e.target.value),placeholder:"StillPlay Capital Partners"}),a.jsx(g.Z,{label:"Email",type:"email",fullWidth:!0,value:A,onChange:e=>S(e.target.value),placeholder:"provider@example.com"}),a.jsx(f.Z,{children:a.jsx(l.Z,{variant:"caption",color:"text.secondary",children:"Payment details"})}),(0,a.jsxs)(o.Z,{direction:"row",spacing:1.5,children:[a.jsx(g.Z,{label:"Bank name",fullWidth:!0,value:I,onChange:e=>R(e.target.value),placeholder:"e.g. GTBank"}),a.jsx(g.Z,{label:"Account number",fullWidth:!0,value:_,onChange:e=>T(e.target.value.replace(/\D/g,"").slice(0,10)),inputProps:{inputMode:"numeric",maxLength:10},placeholder:"0123456789"})]}),a.jsx(f.Z,{children:a.jsx(l.Z,{variant:"caption",color:"text.secondary",children:"Agreement"})}),a.jsx(g.Z,{label:"Agreed capital amount (NGN)",type:"number",inputProps:{min:0,step:1e3},fullWidth:!0,value:D,onChange:e=>F(e.target.value),placeholder:"e.g. 1,000,000",helperText:"Total capital the provider is supplying"}),(0,a.jsxs)(o.Z,{spacing:1.5,children:[a.jsx(g.Z,{label:"Total interest % (charged on loans)",type:"number",inputProps:{min:0,step:.5,max:100},fullWidth:!0,value:E,onChange:e=>L(e.target.value),placeholder:"e.g. 30",helperText:"Total interest added on top of repayments for loans funded by this provider",InputProps:{endAdornment:a.jsx(v.Z,{position:"end",children:"%"})}}),a.jsx(g.Z,{label:"Provider payout % (provider's share)",type:"number",inputProps:{min:0,step:.5,max:ee||100},fullWidth:!0,value:M,onChange:e=>q(e.target.value),error:!!ea,helperText:ea??"The portion paid out to the provider — must be ≤ total %",InputProps:{endAdornment:a.jsx(v.Z,{position:"end",children:"%"})}}),(ee>0||er>0)&&(0,a.jsxs)(s.Z,{sx:{backgroundColor:"#f8f9fb",borderRadius:2,px:2,py:1.5,border:"1px solid #e4e7ec"},children:[a.jsx(l.Z,{variant:"caption",fontWeight:700,color:"text.secondary",children:"SPLIT PREVIEW"}),(0,a.jsxs)(o.Z,{direction:"row",justifyContent:"space-between",sx:{mt:.5},children:[(0,a.jsxs)(o.Z,{children:[(0,a.jsxs)(l.Z,{variant:"body2",fontWeight:600,sx:{color:"#0b7b4c"},children:["Provider gets: ",Math.min(er,ee).toFixed(1),"%"]}),D&&parseFloat(D)>0&&(0,a.jsxs)(l.Z,{variant:"caption",sx:{color:"#0b7b4c"},children:["≈"," ",W(parseFloat(D)*(Math.min(er,ee)/100))]})]}),(0,a.jsxs)(o.Z,{alignItems:"flex-end",children:[(0,a.jsxs)(l.Z,{variant:"body2",fontWeight:600,sx:{color:"#b45309"},children:["Company keeps: ",et.toFixed(1),"%"]}),D&&parseFloat(D)>0&&(0,a.jsxs)(l.Z,{variant:"caption",sx:{color:"#b45309"},children:["≈ ",W(parseFloat(D)*(et/100))]})]})]})]})]}),a.jsx(o.Z,{direction:"row",spacing:1.5,children:a.jsx(g.Z,{label:"Agreed date",type:"date",fullWidth:!0,value:G,onChange:e=>z(e.target.value),InputLabelProps:{shrink:!0}})}),a.jsx(g.Z,{label:"Agreed terms / notes",multiline:!0,rows:3,fullWidth:!0,value:B,onChange:e=>J(e.target.value),placeholder:"Optional notes or terms"}),$.isError&&a.jsx(b.Z,{severity:"error",children:$.error.message})]})}),(0,a.jsxs)(j.Z,{sx:{px:3,pb:2},children:[a.jsx(p.Z,{onClick:Q,children:"Cancel"}),a.jsx(p.Z,{variant:"contained",onClick:()=>{let e=k.trim();if(!e)return;let r=D.trim()?parseFloat(D):void 0;if(void 0!==r&&(isNaN(r)||r<0))return;let t=E.trim()?parseFloat(E):void 0;if(void 0!==t&&(isNaN(t)||t<0))return;let a=M.trim()?parseFloat(M):void 0;!(void 0!==a&&(isNaN(a)||a<0))&&(ea||$.mutate({name:e,email:A.trim()||void 0,accountNumber:_.trim()||void 0,bankName:I.trim()||void 0,agreedAmount:r,percentageToAdd:t,providerCutPercentage:a,agreedAt:G.trim()||void 0,agreedTerms:B.trim()||void 0},{onSuccess:()=>Q()}))},disabled:!k.trim()||!!ea||$.isPending,sx:{backgroundColor:"#0b7b4c"},children:$.isPending?"Creating...":"Register"})]})]})]})}},51034:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>a});let a=(0,t(68570).createProxy)(String.raw`/Users/adamabdullahi/Documents/Js_portfolio/stillPlay/microservices/my-workspace/apps/stillPlay-admin/app/dashboard/providers/page.tsx#default`)}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[898,14,761,108,608,800,326,215,668,437],()=>t(29740));module.exports=a})();